<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transactions - Financial Management System</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <nav class="navbar">
            <div class="nav-brand">
                <h2>Financial Manager</h2>
            </div>
            <ul class="nav-menu">
                <li><a href="/dashboard">Dashboard</a></li>
                <li><a href="/transactions" class="active">Transactions</a></li>
                <li><a href="/profile">Profile</a></li>
                <li><a href="/logout">Logout</a></li>
            </ul>
        </nav>

        <main class="page-content">
            <div class="page-header">
                <h1>All Transactions</h1>
                <a href="/transactions/add" class="btn btn-primary">Add Transaction</a>
            </div>

            <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
            <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

            <div class="transactions-table">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Category</th>
                            <th>Description</th>
                            <th>Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:if="${#lists.isEmpty(transactions)}">
                            <td colspan="6" style="text-align: center;">No transactions found. Add your first transaction!</td>
                        </tr>
                        <tr th:each="transaction : ${transactions}">
                            <td th:text="${#temporals.format(transaction.date, 'yyyy-MM-dd')}"></td>
                            <td>
                                <span th:class="${transaction.type == 'INCOME' ? 'badge badge-income' : 'badge badge-expense'}" 
                                      th:text="${transaction.type}"></span>
                            </td>
                            <td th:text="${transaction.category}"></td>
                            <td th:text="${transaction.description}"></td>
                            <td th:class="${transaction.type == 'INCOME' ? 'amount-income' : 'amount-expense'}" 
                                th:text="'â‚±' + ${#numbers.formatDecimal(transaction.amount, 1, 2)}"></td>
                            <td class="actions">
                                <a th:href="@{/transactions/receipt/{id}(id=${transaction.id})}" class="btn btn-small btn-info" title="View Receipt">ðŸ“„</a>
                                <a th:href="@{/transactions/edit/{id}(id=${transaction.id})}" class="btn btn-small btn-secondary">Edit</a>
                                <form th:action="@{/transactions/delete/{id}(id=${transaction.id})}" method="post" style="display: inline;">
                                    <button type="submit" class="btn btn-small btn-danger" 
                                            onclick="return confirm('Are you sure you want to delete this transaction?')">Delete</button>
                                </form>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </main>

        <footer>
            <p>&copy; 2025 Financial Management System - Isulan, Sultan Kudarat</p>
        </footer>
    </div>
</body>
</html>
